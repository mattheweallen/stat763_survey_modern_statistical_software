---
title: "Stat 763 HW 2"
author: "Matt Allen"
date: "2/15/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("pdftools")
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r readdata}
library(tidyverse)
library("pdftools")
#filenames
heights_file_name <- '/home/rstudio/assign2/heights.pdf'
ice_cream_file_name <- '/home/rstudio/assign2/ice_cream.csv'

#temp_file <- tempfile()
#url <- paste0("http://www.pnas.org/content/suppl/2015/09/16/",
#              "1510159112.DCSupplemental/pnas.201510159SI.pdf")
#download.file(url, temp_file)
#txt <- pdf_text(temp_file)
#file.remove(temp_file)




ice_cream_raw <- read.csv2(ice_cream_file_name,sep=",")
#str_split(ice_cream_raw$preference,",")
#https://tidyr.tidyverse.org/reference/separate.html

ice_cream <- ice_cream_raw %>%
  separate(preference, c("Preference_1","Preference_2","Preference_3"), 
           sep = ",", remove = TRUE, convert = FALSE, extra = "warn", fill = "warn") %>%
  mutate_all(str_trim)


#heights_raw <- pdf_text(heights_file_name)




str_split(heights[[2]],"\\s+")

heights




blarg <- ice_cream_raw %>%
  separate(preference, heights_col_names, 
           sep = "\\s+", remove = TRUE, convert = FALSE, extra = "warn", fill = "warn")


#https://stackoverflow.com/questions/48833807/initialize-an-empty-tibble-with-column-names-and-0-rows

create_heights_tibble <- function(heights_pdf_text) {
  page_num <- 1
  row_num <- 2 # start row num at 2 because first page has columns
  
  
  heights <- str_split(heights_pdf_text, "\n") 
  heights_col_names <- str_split(heights[[page_num]][row_num],"\\s+")
  
  
  
  testy <- tibble()
  for(page in heights) {
    #if(page_num == 1 && row_num == 1) {
      #the first page has the row headers so need to process that one differently
      #heights_col_names <- str_split(heights[[1]][1],"\\s+")
      #create data table
    #}
    for(row in page) {
      
    }
    row_num <- 1
    page_num = page_num + 1
    
  }
  return(testy)
}

heights <- create_heights_tibble(pdf_text(heights_file_name))


##
for(page in heights) {
  rows = str_split(page,"\\s+")
  rbind()
}

```